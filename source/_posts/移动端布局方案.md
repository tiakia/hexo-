---
title: 移动端布局方案
tags: [rem, vw]
date: 2017-12-28 11:15:52
categories: css
description: 移动端手机布局方案
thumbnail:
keywords: rem, vw, em
---
面试的时候被问到了，移动端的布局，一直没有总结，在这里做个总结，移动端的布局方案。  
初始的移动端布局采用的是bootstrap的`media query`方案，后来演变到`em`，再到现在的`rem`，配合`js`,或配合`vw`和`scss`，再加上`flex box`弹性盒子布局，还有正在酝酿的`css grid`方案，在实际工作中应该灵活应用，而不是一味的使用`rem`或`flex`等。
### em
在使用`em`作单位时，一定需要知道其父元素的设置，因为`em`就是一个相对值，而且是一个相对于父元素的值.  
```
.parent{
    font-size: 16px;
}
.child{
    font-size: 2em; // 16px * 2
    line-height: 2em; // 64px
}
```
`em`在做字体的单位时，相对于父元素`font-size`，而在做其他单位时，相对于的是自身的`font-size`大小
### rem
`rem`则是相对于根元素`html`来进行计算的，如果子元素设置`rem`那么通过更改根元素`html`元素的字体大小，就可以让子元素的大小发生变化，这实际上也是一种等比缩放。   
```
html{
    font-size: 100px;
}
div{
    width: 1rem;//100px
    height: .5rem;//50px
}
```
那么，`div`的宽就是 `100px` 高是 `50px`。  
在实际工作中，可以使用`js`获取`clientWidth`来计算根元素`html`的`font-size`大小，或者使用`scss`来计算
#### rem & js
```
(function (doc, win) {
    var docEl = doc.documentElement,
    //横向屏幕
        resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
        recalc = function () {
            var clientWidth = docEl.clientWidth;
            if (!clientWidth) return;
            if(clientWidth>=640){
                docEl.style.fontSize = '100px';
            }else{
                docEl.style.fontSize = 100 * (clientWidth / 640) + 'px';
            }
        };
    if (!doc.addEventListener) return;
    win.addEventListener(resizeEvt, recalc, false);
    doc.addEventListener('DOMContentLoaded', recalc, false);
})(document, window);
```
代码解释：  
如果页面的宽度超过了640px，那么页面中html的font-size恒为100px，否则，页面中html的font-size的大小为： 100 * (当前页面宽度 / 640)  
这个要根据自己的实际项目设置（设计稿为准）。  
**以 640px 为基准**
屏幕宽度 | 320 | 480 | 640 
---|---|---|---
 屏幕对比比例| 0.5 | 0.75 | 1| 
HTML font-size | 50px | 75px | 100px
1rem| 50px|75px|100px
###### 或者如果知道项目的主流媒体设备的话也可以使用`media-query`设置`html`的`font-size`但是这个方案不推荐

#### rem & scss
使用`scss`直接把`px`转为  `rem`  
#### `公式：元素宽度 / 设计图宽度 * 100`
```
$base-font-size: 64px;//根据项目具体设置
@function toRem($px){
    @return  ($px/$base-font-size) * 1rem;
}
html{
    font-size: $base-font-size;
}
p{
    width: toRem(10px);
}
```
**$base-font-size**的计算，为了更好的兼容`vw`和`vh`把设计稿分成100份（`100vw = 视口宽度`）,而每一份被称为一个单位`x`。同时`1rem`单位被认定为`10x`。  
如果设计师给的图是`640`的话，针对我们这份视觉稿可以计算出：
```
//1rem = 10x;
1x = 6.4px;
1rem = 64px;
```
在实际项目中可以根据`js`来，动态的设置`$base-font-size`,要注意的是，要把计算`$base-font-size`的代码放到加载css代码之前。
### 总结
1.设置meta标签的scale
```
var scale = 1 / devicePixelRatio;
document.querySelector('meta[name="viewport"]').setAttribute('content','initial-scale=' + scale + ', maximum-scale=' + scale + ', minimum-scale=' + scale + ', user-scalable=no');
```
2.动态计算html的font-size
```
document.documentElement.style.fontSize = document.documentElement.clientWidth / 10 + 'px';

```
3.布局的时候，各元素的css尺寸=设计稿标注尺寸/设计稿横向分辨率/10(借助Scss实现)  
4.font-size可能需要额外的媒介查询，并且font-size不使用rem，这一点跟网易是一样的。  
5.设置max-width，当宽度大于这个max-width的时候，左右居中。
